(this["webpackJsonponline-store-front"]=this["webpackJsonponline-store-front"]||[]).push([[0],{32:function(t,e,a){},34:function(t,e,a){},55:function(t,e,a){"use strict";a.r(e);var s=a(1),c=a.n(s),r=a(23),n=a.n(r),o=(a(32),a(6)),i=a(7),l=a.n(i),d=a(5),u=a(14),j=a(24),m=a(25),b=a(27),h=a(26),x=(a(34),a(8)),O=a.n(x),p=a(12),f=a(2),v=c.a.createContext({}),g=a(0),N=function(t){return function(e){return Object(g.jsx)(v.Consumer,{children:function(a){return Object(g.jsx)(t,Object(o.a)(Object(o.a)({},e),{},{context:a}))}})}},C=function(t){var e=t.cartItem,a=t.cartKey,s=e.product,c=e.amount;return Object(g.jsx)("div",{className:" column is-half",children:Object(g.jsx)("div",{className:"box",children:Object(g.jsxs)("div",{className:"media",children:[Object(g.jsx)("div",{className:"media-left",children:Object(g.jsx)("figure",{className:"image is-64x64",children:Object(g.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:s.shortDesc})})}),Object(g.jsxs)("div",{className:"media-content",children:[Object(g.jsxs)("b",{style:{textTransform:"capitalize"},children:[s.name," ",Object(g.jsxs)("span",{className:"tag is-primary",children:["$",s.price]})]}),Object(g.jsx)("div",{children:s.shortDesc}),Object(g.jsx)("small",{children:"".concat(c," in cart")})]}),Object(g.jsx)("div",{className:"media-right",onClick:function(){return t.removeFromCart(a)},children:Object(g.jsx)("span",{className:"delete is-large"})})]})})})},k=function(t){var e=t.message;return null===e?null:Object(g.jsx)("div",{className:"error",children:e})},y=N((function(t){var e=t.context.cart,a=Object.keys(e||{});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"hero is-primary",children:Object(g.jsx)("div",{className:"hero-body container",children:Object(g.jsx)("h4",{className:"title",children:"My Cart"})})}),Object(g.jsx)("br",{}),Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)(k,{message:t.context.notify}),a.length?Object(g.jsxs)("div",{className:"column columns is-multiline",children:[a.map((function(a){return Object(g.jsx)(C,{cartKey:a,cartItem:e[a],removeFromCart:t.context.removeFromCart},a)})),Object(g.jsxs)("div",{className:"column is-12 is-clearfix",children:[Object(g.jsx)("br",{}),Object(g.jsxs)("div",{className:"is-pulled-right",children:[Object(g.jsx)("button",{onClick:t.context.clearCart,className:"button is-warning ",children:"Clear cart"})," ",Object(g.jsx)("button",{className:"button is-success",onClick:t.context.checkout,children:"Checkout"})]})]})]}):Object(g.jsx)("div",{className:"column"})]}),Object(g.jsxs)("div",{className:"title has-text-grey-light",children:[Object(g.jsx)(k,{message:t.context.notification})," "]})]})})),S=function(t){var e=t.product;return Object(g.jsx)("div",{className:" column is-half",children:Object(g.jsx)("div",{className:"box",children:Object(g.jsxs)("div",{className:"media",children:[Object(g.jsx)("div",{className:"media-left",children:Object(g.jsx)("figure",{className:"image is-64x64",children:Object(g.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:e.shortDesc})})}),Object(g.jsxs)("div",{className:"media-content",children:[Object(g.jsxs)("b",{style:{textTransform:"capitalize"},children:[e.name," ",Object(g.jsxs)("span",{className:"tag is-black",children:["$",e.price]})]}),Object(g.jsx)("div",{}),e.stock>0?Object(g.jsx)("small",{children:e.stock+" Available"}):Object(g.jsx)("small",{className:"has-text-danger",children:"Out Of Stock"}),Object(g.jsx)("div",{className:"is-clearfix",children:e.stock>0?Object(g.jsx)("button",{className:"button is-small is-outlined is-primary   is-pulled-right",onClick:function(){return t.addToCart({id:e.name,product:e,amount:1})},children:"Add to Cart"}):""})]})]})})})},T=N((function(t){var e=t.context.products;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",{className:"hero is-danger",children:Object(g.jsx)("div",{className:"hero-body container",children:Object(g.jsx)("h4",{className:"title",children:"Our Products"})})}),Object(g.jsx)("br",{}),Object(g.jsx)("div",{className:"container",children:Object(g.jsx)("div",{className:"column columns is-multiline",children:e&&e.length?e.map((function(e,a){return Object(g.jsx)(S,{product:e,addToCart:t.context.addToCart},a)})):Object(g.jsx)("div",{className:"column",children:Object(g.jsx)("span",{className:"title has-text-grey-light",children:"No products found!"})})})})]})})),w=function(t){Object(b.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(j.a)(this,a),(s=e.call(this,t)).addToCart=function(t){console.log("addToChart funktio");var e=s.state.cart;e[t.id]?e[t.id].amount+=t.amount:e[t.id]=t,e[t.id].amount>e[t.id].product.stock&&(e[t.id].amount=e[t.id].product.stock),localStorage.setItem("cart",JSON.stringify(e)),console.log(e,"add to cart() funktio asetetaan cart localstoreeen"),s.setState({cart:e}),console.log(s.state.cart,"asetetaan cart state")},s.removeFromCart=function(t){var e=s.state.cart;delete e[t],localStorage.setItem("cart",JSON.stringify(e)),s.setState({cart:e})},s.clearCart=function(){console.log("clearCart localstore ja state.cart tyhj\xe4ys");localStorage.removeItem("cart"),s.setState({cart:{}})},s.checkout=Object(u.a)(l.a.mark((function t(){var e,a,c,r,n,o,i,u,j,m,b,h,x,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=s.state.cart,a=[],c=0,r=Object.entries(e);c<r.length;c++)n=Object(d.a)(r[c],2),o=n[0],i=n[1],console.log(o,i),console.log(i.product.id,i.amount),u=i.product.id,j=i.product.name,m=i.product.price,b=i.amount,a.push({id:u,name:j,amount:b,price:m});return h={products:a},console.log("Order to sent to service:",h),t.prev=5,t.next=8,O.a.post("/api/orders",h);case 8:if(x=t.sent,console.log("post response data from or orderservisefront",x.data),"OK"!==x.data.status){t.next=14;break}return console.log("POST status OK"),t.next=14,O.a.get("/api/products").then((function(t){console.log("resp data/orders from invenrory",t.data),s.setState({products:t.data}),console.log("state after",s.state.products),s.clearCart(),s.setState({notification:"Thank you for your order,  Order sent succefully"}),setTimeout((function(){s.setState({notification:null})}),5e3)}));case 14:if("NOT_OK"!==x.data.status){t.next=24;break}return console.log("POST NOT OK, Tilaus ei onnistunut joitain tuotteita ei satavilla"),(p=x.data.products.filter((function(t){return"NOT_OK"===t.status}))).forEach((function(t){return console.log(t.name)})),p.forEach((function(t){return s.setState({notification:"OUT OF STOCK: ".concat(t.name,"   Please replace the order!!!!")})})),setTimeout((function(){s.setState({notification:null})}),9e3),t.next=22,O.a.get("/api/products").then((function(t){console.log("resp data/orders from invenrory",t.data),s.setState({products:t.data}),console.log("state after",s.state.products),s.clearCart()}));case 22:t.next=25;break;case 24:console.log("Tilaus ei onnistunu something went wrong");case 25:return t.abrupt("return",x.data);case 28:t.prev=28,t.t0=t.catch(5),s.setState({notification:"Something went wrong. Please replace the order!."}),setTimeout((function(){s.setState({notification:null})}),5e3);case 32:case"end":return t.stop()}}),t,null,[[5,28]])}))),s.state={cart:{},products:[],notification:""},s}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var t=Object(u.a)(l.a.mark((function t(){var e,a=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("didmount"),e=localStorage.getItem("cart"),t.next=4,O.a.get("/api/products").then((function(t){var s=t.data;console.log("products",s),console.log("this",a.state),e=e?JSON.parse(e):{},console.log("after"),a.setState({products:s,cart:e}),console.log("set this state to products and casrds",a.state)}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this;return Object(g.jsx)(v.Provider,{value:Object(o.a)(Object(o.a)({},this.state),{},{removeFromCart:this.removeFromCart,addToCart:this.addToCart,clearCart:this.clearCart,checkout:this.checkout,notifify:this.state.notification}),children:Object(g.jsx)(p.a,{children:Object(g.jsxs)("div",{className:"App",children:[Object(g.jsxs)("nav",{className:"navbar container",role:"navigation","aria-label":"main navigation",children:[Object(g.jsxs)("div",{className:"navbar-brand",children:[Object(g.jsx)("b",{className:"navbar-item is-size-4",children:"Online store"}),Object(g.jsxs)("label",{role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:function(e){e.preventDefault(),t.setState({showMenu:!t.state.showMenu})},children:[Object(g.jsx)("span",{"aria-hidden":"true"}),Object(g.jsx)("span",{"aria-hidden":"true"}),Object(g.jsx)("span",{"aria-hidden":"true"})]})]}),Object(g.jsxs)("div",{className:"navbar-menu",children:[Object(g.jsx)(p.b,{to:"/",className:"navbar-item",children:"Products"}),Object(g.jsxs)(p.b,{to:"/cart",className:"navbar-item",children:["Cart",Object(g.jsx)("span",{className:"tag is-primary",style:{marginLeft:"5px"},children:Object.keys(this.state.cart).length})]})]})]}),Object(g.jsxs)(f.c,{children:[Object(g.jsx)(f.a,{exact:!0,path:"/",element:Object(g.jsx)(T,{})}),Object(g.jsx)(f.a,{exact:!0,path:"/cart",element:Object(g.jsx)(y,{})})]})]})})})}}]),a}(s.Component);a(54);n.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(w,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.67a2ff74.chunk.js.map