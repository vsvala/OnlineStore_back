(this["webpackJsonponline-store-front"]=this["webpackJsonponline-store-front"]||[]).push([[0],{32:function(e,t,a){},34:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var c=a(1),s=a.n(c),r=a(23),n=a.n(r),o=(a(32),a(6)),i=a(7),l=a.n(i),d=a(5),j=a(14),u=a(24),m=a(25),b=a(27),h=a(26),x=(a(34),a(11)),O=a.n(x),p=a(12),v=a(2),g=s.a.createContext({}),f=a(0),N=function(e){return function(t){return Object(f.jsx)(g.Consumer,{children:function(a){return Object(f.jsx)(e,Object(o.a)(Object(o.a)({},t),{},{context:a}))}})}},C=function(e){var t=e.cartItem,a=e.cartKey,c=t.product,s=t.amount;return Object(f.jsx)("div",{className:" column is-half",children:Object(f.jsx)("div",{className:"box",children:Object(f.jsxs)("div",{className:"media",children:[Object(f.jsx)("div",{className:"media-left",children:Object(f.jsx)("figure",{className:"image is-64x64",children:Object(f.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:c.shortDesc})})}),Object(f.jsxs)("div",{className:"media-content",children:[Object(f.jsxs)("b",{style:{textTransform:"capitalize"},children:[c.name," ",Object(f.jsxs)("span",{className:"tag is-primary",children:["$",c.price]})]}),Object(f.jsx)("div",{children:c.shortDesc}),Object(f.jsx)("small",{children:"".concat(s," in cart")})]}),Object(f.jsx)("div",{className:"media-right",onClick:function(){return e.removeFromCart(a)},children:Object(f.jsx)("span",{className:"delete is-large"})})]})})})},k=N((function(e){var t=e.context.cart,a=Object.keys(t||{});return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"hero is-primary",children:Object(f.jsx)("div",{className:"hero-body container",children:Object(f.jsx)("h4",{className:"title",children:"My Cart"})})}),Object(f.jsx)("br",{}),Object(f.jsx)("div",{className:"container",children:a.length?Object(f.jsxs)("div",{className:"column columns is-multiline",children:[a.map((function(a){return Object(f.jsx)(C,{cartKey:a,cartItem:t[a],removeFromCart:e.context.removeFromCart},a)})),Object(f.jsxs)("div",{className:"column is-12 is-clearfix",children:[Object(f.jsx)("br",{}),Object(f.jsxs)("div",{className:"is-pulled-right",children:[Object(f.jsx)("button",{onClick:e.context.clearCart,className:"button is-warning ",children:"Clear cart"})," ",Object(f.jsx)("button",{className:"button is-success",onClick:e.context.checkout,children:"Checkout"})]})]})]}):Object(f.jsx)("div",{className:"column",children:Object(f.jsx)("div",{className:"title has-text-grey-light",children:"Order sent cuccesfully!"})})})]})})),y=function(e){var t=e.product;return Object(f.jsx)("div",{className:" column is-half",children:Object(f.jsx)("div",{className:"box",children:Object(f.jsxs)("div",{className:"media",children:[Object(f.jsx)("div",{className:"media-left",children:Object(f.jsx)("figure",{className:"image is-64x64",children:Object(f.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:t.shortDesc})})}),Object(f.jsxs)("div",{className:"media-content",children:[Object(f.jsxs)("b",{style:{textTransform:"capitalize"},children:[t.name," ",Object(f.jsxs)("span",{className:"tag is-black",children:["$",t.price]})]}),Object(f.jsx)("div",{children:t.shortDesc}),t.stock>0?Object(f.jsx)("small",{children:t.stock+" Available"}):Object(f.jsx)("small",{className:"has-text-danger",children:"Out Of Stock"}),Object(f.jsx)("div",{className:"is-clearfix",children:Object(f.jsx)("button",{className:"button is-small is-outlined is-primary   is-pulled-right",onClick:function(){return e.addToCart({id:t.name,product:t,amount:1})},children:"Add to Cart"})})]})]})})})},S=N((function(e){var t=e.context.products;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"hero is-danger",children:Object(f.jsx)("div",{className:"hero-body container",children:Object(f.jsx)("h4",{className:"title",children:"Our Products"})})}),Object(f.jsx)("br",{}),Object(f.jsx)("div",{className:"container",children:Object(f.jsx)("div",{className:"column columns is-multiline",children:t&&t.length?t.map((function(t,a){return Object(f.jsx)(y,{product:t,addToCart:e.context.addToCart},a)})):Object(f.jsx)("div",{className:"column",children:Object(f.jsx)("span",{className:"title has-text-grey-light",children:"No products found!"})})})})]})})),T="http://nginx:9000",w=function(e){Object(b.a)(a,e);var t=Object(h.a)(a);function a(e){var c;return Object(u.a)(this,a),(c=t.call(this,e)).addToCart=function(e){console.log("addToChart funktio");var t=c.state.cart;t[e.id]?t[e.id].amount+=e.amount:t[e.id]=e,t[e.id].amount>t[e.id].product.stock&&(t[e.id].amount=t[e.id].product.stock),localStorage.setItem("cart",JSON.stringify(t)),console.log(t,"add to cart() funktio asetetaan cart localstoreeen"),c.setState({cart:t}),console.log(c.state.cart,"asetetaan cart state")},c.removeFromCart=function(e){var t=c.state.cart;delete t[e],localStorage.setItem("cart",JSON.stringify(t)),c.setState({cart:t})},c.clearCart=function(){console.log("clearCart localstore ja state.cart tyhj\xe4ys");localStorage.removeItem("cart"),c.setState({cart:{}})},c.checkout=Object(j.a)(l.a.mark((function e(){var t,a,s,r,n,o,i,j,u,m,b,h,x;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=c.state.cart,a=[],console.log("cart from checkout",c.state.cart),s=0,r=Object.entries(t);s<r.length;s++)n=Object(d.a)(r[s],2),o=n[0],i=n[1],console.log(o,i),console.log(i.product.id,i.amount),j=i.product.id,u=i.product.name,m=i.product.price,b=i.amount,a.push({id:j,amount:b,name:u,price:m});return console.log(a,"orderlist"),h={products:a},console.log(h,"Allaaaa"),e.prev=7,e.next=10,O.a.post("http://localhost:3001/api/orders",h);case 10:if(x=e.sent,console.log("response data from post",x.data),"OK"!==x.data.status){e.next=18;break}return console.log("status OK"),e.next=16,O.a.get(T+"/api/products").then((function(e){console.log("resp data/orders from invenrory",e.data);var t=e.data;console.log("puuttuva",e.data.products[1].id),c.setState({products:t}),c.clearCart()}));case 16:e.next=21;break;case 18:console.log("Tilaus ei onnistunu"),console.log("Out of stock seuraavat tuotteet"),console.log(x.data.products.name);case 21:return e.abrupt("return",x.data);case 24:return e.prev=24,e.t0=e.catch(7),e.abrupt("return",{error:"Could not sent order"});case 27:case"end":return e.stop()}}),e,null,[[7,24]])}))),c.state={cart:{},products:[]},c}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(j.a)(l.a.mark((function e(){var t,a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("didmount"),t=localStorage.getItem("cart"),e.next=4,O.a.get(T+"/api/v1/products").then((function(e){var c=e.data;console.log("products",{products:c}),console.log("this",a.state),t=t?JSON.parse(t):{},a.setState({products:c,cart:t}),console.log("set this state to products and casrds",a.state)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(f.jsx)(g.Provider,{value:Object(o.a)(Object(o.a)({},this.state),{},{removeFromCart:this.removeFromCart,addToCart:this.addToCart,clearCart:this.clearCart,checkout:this.checkout}),children:Object(f.jsx)(p.a,{children:Object(f.jsxs)("div",{className:"App",children:[Object(f.jsxs)("nav",{className:"navbar container",role:"navigation","aria-label":"main navigation",children:[Object(f.jsxs)("div",{className:"navbar-brand",children:[Object(f.jsx)("b",{className:"navbar-item is-size-4",children:"Online store"}),Object(f.jsxs)("label",{role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:function(t){t.preventDefault(),e.setState({showMenu:!e.state.showMenu})},children:[Object(f.jsx)("span",{"aria-hidden":"true"}),Object(f.jsx)("span",{"aria-hidden":"true"}),Object(f.jsx)("span",{"aria-hidden":"true"})]})]}),Object(f.jsxs)("div",{className:"navbar-menu",children:[Object(f.jsx)(p.b,{to:"/products",className:"navbar-item",children:"Products"}),Object(f.jsxs)(p.b,{to:"/cart",className:"navbar-item",children:["Cart",Object(f.jsx)("span",{className:"tag is-primary",style:{marginLeft:"5px"},children:Object.keys(this.state.cart).length})]})]})]}),Object(f.jsxs)(v.c,{children:[Object(f.jsx)(v.a,{exact:!0,path:"/",element:Object(f.jsx)(S,{})}),Object(f.jsx)(v.a,{exact:!0,path:"/cart",element:Object(f.jsx)(k,{})}),Object(f.jsx)(v.a,{exact:!0,path:"/products",element:Object(f.jsx)(S,{})})]})]})})})}}]),a}(c.Component);a(54);n.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(w,{})}),document.getElementById("root"))}},[[55,1,2]]]);
//# sourceMappingURL=main.c75aa552.chunk.js.map